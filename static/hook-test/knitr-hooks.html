---
title: "Hook Testing"
author: '@jemus42'
date: "5/16/2020"
output: github_document
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<pre class="r"><code>knitr::knit_hooks$set(source = function(x, options) {

  # The original source in a fenced code block
  source_orig &lt;- paste(c(&quot;```r&quot;, x, &quot;```&quot;), collapse = &quot;\n&quot;)

  fold_option &lt;- options[[&quot;code_fold&quot;]]

  # If option not set or explicitly FALSE, return regular code chunk
  if (is.null(fold_option) | isFALSE(fold_option)) {
   return(source_orig) 
  } 
  
  summary_text &lt;- ifelse(
    is.character(fold_option), # If the option is text,
    fold_option,               # use it as &lt;summary&gt;Label&lt;/summary&gt;,
    &quot;Click to expand&quot;          # otherwise here&#39;s a default
  )
  
  # Output details tag
  glue::glue(
    &quot;&lt;details&gt;
      &lt;summary&gt;{summary_text}&lt;/summary&gt;
      {source_orig}
    &lt;/details&gt;&quot;
  )
})</code></pre>
<div id="regular-output-as-usual-code_fold-not-set" class="section level3">
<h3>Regular output as usual, <code>code_fold</code> not set</h3>
<pre class="r"><code>library(dplyr, warn.conflicts = FALSE)
iris %&gt;%
  filter(Sepal.Width &gt; 3) %&gt;%
  head(5)</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.7         3.2          1.3         0.2  setosa
## 3          4.6         3.1          1.5         0.2  setosa
## 4          5.0         3.6          1.4         0.2  setosa
## 5          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="hidden-source-custom-summary-code_foldi-heard-you-like-flowers" class="section level3">
<h3>Hidden source, custom summary, <code>code_fold="I heard you like flowers"</code></h3>
<details>
<summary>I heard you like flowers</summary>
<code>r iris %&gt;%   filter(Sepal.Width &gt; 3) %&gt;%   head(5)</code>
</details>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.7         3.2          1.3         0.2  setosa
## 3          4.6         3.1          1.5         0.2  setosa
## 4          5.0         3.6          1.4         0.2  setosa
## 5          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="hidden-source-default-summary-code_foldtrue" class="section level3">
<h3>Hidden source, default summary, <code>code_fold=TRUE</code></h3>
<details>
<summary>Click to expand</summary>
<code>r iris %&gt;%   filter(Sepal.Width &gt; 3) %&gt;%   head(5)</code>
</details>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.7         3.2          1.3         0.2  setosa
## 3          4.6         3.1          1.5         0.2  setosa
## 4          5.0         3.6          1.4         0.2  setosa
## 5          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="source-shown-code_foldfalse" class="section level3">
<h3>Source shown, <code>code_fold=FALSE</code></h3>
<pre class="r"><code>iris %&gt;%
  filter(Sepal.Width &gt; 3) %&gt;%
  head(5)</code></pre>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.7         3.2          1.3         0.2  setosa
## 3          4.6         3.1          1.5         0.2  setosa
## 4          5.0         3.6          1.4         0.2  setosa
## 5          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
